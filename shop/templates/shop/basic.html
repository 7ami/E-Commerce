<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Lobster&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
<!-- Bootstrap core CSS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
<!-- Material Design Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.10.1/css/mdb.min.css" rel="stylesheet">
    <title>{% block title%} {% endblock %}</title>
    <style>
      a.navbar-brand {
          font-family: 'Lobster', cursive;
          color: aliceblue;
      }

      .custom-nav {
          background-color: rgb(30, 77, 3);
      }

      .custom-dropdown button {
          background-color: rgb(30, 77, 3);
          color: aliceblue;
      }

      .custom-dropdown button:hover {
          color: aliceblue;
          background-color: rgb(27, 65, 5);
          ;
      }

      img {
          display: block;
          max-width: 100%;
          height: auto;
      }

          {
          % block style %
      }

          { % endblock %}
  </style>
      <style>
         {% block css%} {% endblock %}
  </style>
  </head>
  <body>

    <nav class="navbar navbar-expand-lg navbar-dark custom-nav sticky-top">
  <a class="navbar-brand" href="#">Green Nett</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>



  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="/shop">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/shop/prod">Products</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/shop/about">About Us</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/shop/contact">Contact Us</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/shop/tracker">Tracker</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/shop/checkout">Checkout</a>
      </li>
        
    </ul>
    <form class="form-inline my-2 my-lg-0">
      <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
    <button type="button" id="popcart" class="btn btn-secondary mx-2" data-container="body" data-html="true" data-toggle="popover" data-placement="bottom" data-content="Vivamus
sagittis lacus vel augue laoreet rutrum faucibus.">
   Cart(<span id="cart">0</span>)
</button>
  </div>
  <ul class="navbar-nav mr-auto">
    <li class="nav-item">
      <a class="nav-link" href="#">Sign Up</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#">Log In</a>
    </li>
  </ul>
 
</nav>

    {% block body%} {% endblock %}
  <!-- Footer -->
<footer class="page-footer font-small green darken-3">

  <!-- Footer Elements -->
  <div class="container">

    <!-- Grid row-->
    <div class="row">

      <!-- Grid column -->
      <div class="col-md-12 py-5">
        <div class="mb-5 flex-center">

          <!-- Facebook -->
          <a class="fb-ic">
            <i class="fab fa-facebook-f fa-lg white-text mr-md-5 mr-3 fa-2x"> </i>
          </a>
          <!-- Twitter -->
          <a class="tw-ic">
            <i class="fab fa-twitter fa-lg white-text mr-md-5 mr-3 fa-2x"> </i>
          </a>
          <!-- Google +-->
          <a class="gplus-ic">
            <i class="fab fa-google-plus-g fa-lg white-text mr-md-5 mr-3 fa-2x"> </i>
          </a>
          <!--Linkedin -->
          <a class="li-ic">
            <i class="fab fa-linkedin-in fa-lg white-text mr-md-5 mr-3 fa-2x"> </i>
          </a>
          <!--Instagram-->
          <a class="ins-ic">
            <i class="fab fa-instagram fa-lg white-text mr-md-5 mr-3 fa-2x"> </i>
          </a>
          <!--Pinterest-->
          <a class="pin-ic">
            <i class="fab fa-pinterest fa-lg white-text fa-2x"> </i>
          </a>
        </div>
      </div>
      <!-- Grid column -->

    </div>
    <!-- Grid row-->

  </div>
  <!-- Footer Elements -->

  <!-- Copyright -->
  <div class="footer-copyright text-center py-3">Â© 2020 Copyright:
    <a href="#"> greenNett.com</a>
  </div>
  <!-- Copyright -->

</footer>
<!-- Footer -->   

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
<!-- JQuery -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.10.1/js/mdb.min.js"></script>
{% block js%}


<script type ="text/javascript">

if(localStorage.getItem('cart') == null){
     var cart = {};
}else
{
  cart = JSON.parse(localStorage.getItem('cart'));
  document.getElementById('cart').innerHTML = Object.keys(cart).length;
  updcart(cart);
}
$('.divpr').on('click', 'button.cart', function(){
var idstr = this.id.toString();
if( cart[idstr] != undefined){
qty=card[idstr][0]+1;
name = "My Item";
card[idstr]= [qty,name];
} else{
  qty=1;
  name = "My Item";
  cart[idstr] =[qty,name];
}
updcart(cart);
});
//popover to cart
$('#popcart').popover();
updpopover(cart);

//working on popover
function updpopover(cart)
{
   
   var popstr = "";
   popstr = popstr + "<h5>Items in your Cart!</h5><div class='mx-2 my-2'>";
   var z=1;
   for(var item in cart)
   {
     popstr = popstr +"<b>"+z+"</b>.";
     popstr = popstr + document.getElementById('name'+item).innerHTML.slice(0,20) + "...Qty:" + cart[item][0] +'<br>';
     z=z+1;
   }   
   popstr = popstr + "</div> <a href='/shop/checkout'><button class='btn btn-success' id ='checkout'>Checkout</button></a> <button class='btn btn-success' onclick='clearCart()' id ='clearCart'>Clear Cart</button>"
   document.getElementById('popcart').setAttribute('data-content',popstr);
   $('#popcart').popover('show');


}
function clearCart() {
    cart = JSON.parse(localStorage.getItem('cart'));
    for (var item in cart) {
        document.getElementById('div' + item).innerHTML = '<button id="' + item + '" class="btn btn-success cart">Add To Cart</button>'
    }
    localStorage.clear();
    location = window.location
    cart = {};
    updateCart(cart);
}


//+ 5- ->UI
function updcart(cart){
   var sum = 0;
   for(var item in cart){
      sum =sum + cart[item][0];
      document.getElementById('div'+item).innerHTML = "<button id='minus" + item + "' class='btn btn-success minus'>-</button> <span id='val" + item + "''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-success plus'> + </button>";
    }
    localStorage.setItem('cart',JSON.stringify(cart));
    document.getElementById('cart').innerHTML = sum;
    updpopover(cart);
}


//working on plus minus button
$('.divpr').on("click","button.minus",function(){
    
    //id gives minusprK
     k=this.id.slice(7,);
     console.log(k);
    cart['pr' + k][0]=cart['pr' + k][0]-1;
    cart['pr' + k][0]=Math.max(0,cart['pr'+ k][0]);
    if(cart['pr' + k][0] ==0){
         document.getElementById('divpr' + k).innerHTML = '<button id="pr'+k+'" class="btn btn-success cart">Add to Cart</button>';
        delete cart['pr'+k];
    }else{
    document.getElementById('valpr'+k).innerHTML=cart['pr'+k][0];
    }
    updcart(cart);
});



//working on plus plus button
$('.divpr').on("click","button.plus",function(){
     console.log("plus clicked");
     //id gives plusprq
     q=this.id.slice(6,);
     cart['pr'+q][0]=cart['pr'+q][0]+1;
    document.getElementById('valpr'+q).innerHTML=cart['pr'+q][0];
    updcart(cart);

});

</script>

{% endblock %}

  </body>
</html>
